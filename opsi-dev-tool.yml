project:
  name: opsi-server
  version: 4.2.0
  description: opsi server
  homepage: http://www.opsi.org
  license: AGPL-3.0
  maintainer: uib GmbH <info@uib.de>

package:
  name: opsi-server
  type: binary
  architecture: all
  depends:
    - opsiconfd (>= 4.2)
    #- opsipxeconfd (>= 4.2)
    - opsi-linux-bootimage (>= 20170620)
    - opsi-tftpd
    - opsi-utils (>= 4.2)
    - samba
    - sudo
    - wget
  suggests:
    - mariadb-server
    - opsi-windows-support
    - opsi-linux-support
  provides:
    - opsi-depotserver
  breaks:
    - opsi-depotserver (<< 4.1)
  conflicts:
    - opsi-server-expert
  replaces:
    - opsi-depotserver (<< 4.1), opsi-depotserver-expert
  source_script:
    - mkdir -p "${DST}/rootfs/var/lib/opsi/depot"
    - mkdir -p "${DST}/rootfs/var/lib/opsi/ntfs-images"
    - mkdir -p "${DST}/rootfs/var/lib/opsi/repository"
    - mkdir -p "${DST}/rootfs/var/lib/opsi/workbench"
    - mkdir -p "${DST}/rootfs/var/log/opsi/bootimage"
    - mkdir -p "${DST}/rootfs/var/log/opsi/clientconnect"
    - mkdir -p "${DST}/rootfs/var/log/opsi/instlog"
    - mkdir -p "${DST}/rootfs/var/log/opsi/userlogin"
    - cp -a "${SRC}/opsi-server_data/etc" "${DST}/rootfs/etc"
  subpackages:
    - name: expert
      depends:
        - opsiconfd (>= 4.2)
        #- opsipxeconfd (>= 4.2)
        - opsi-linux-bootimage (>= 20170620)
        - opsi-tftpd
        - opsi-utils (>= 4.2)
